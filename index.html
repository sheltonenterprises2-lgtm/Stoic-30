<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Stoic 30</title>

  <style>
    :root{
      color-scheme: dark;
      --bg:#0b0f14;
      --card:#0f1620;
      --border:#1f2a37;
      --btn:#152233;
      --btnBorder:#263548;
      --primary:#1a2e49;
      --primaryBorder:#2a446b;
      --ink:#e6edf3;
      --muted:#9fb0c0;
      --pad: clamp(12px, 3.5vw, 20px);
      --gap: clamp(8px, 2.5vw, 12px);
      --radius: 14px;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:var(--ink);
      -webkit-text-size-adjust:100%;
    }

    .container{
      max-width:980px;
      margin:0 auto;
      padding:var(--pad);
      padding-bottom:calc(var(--pad) + env(safe-area-inset-bottom));
      padding-top:calc(var(--pad) + env(safe-area-inset-top));
    }

    .row{ display:flex; gap:var(--gap); flex-wrap:wrap; align-items:center; }
    .space{ justify-content:space-between; }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:clamp(14px, 3.5vw, 18px);
    }

    .btn{
      background:var(--btn);
      border:1px solid var(--btnBorder);
      color:var(--ink);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      min-height:44px;
      touch-action:manipulation;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }
    .btn:hover{ filter:brightness(1.08); }
    .btn:active{ transform:translateY(1px); }

    .btn.primary{
      background:var(--primary);
      border-color:var(--primaryBorder);
    }

    .small{ font-size:clamp(12px, 3.2vw, 13px); color:var(--muted); line-height:1.35; }
    .h1{ font-size:clamp(20px, 5vw, 26px); margin:0 0 10px; }
    .h2{ font-size:clamp(15px, 4.2vw, 17px); margin:0 0 6px; color:#cfe3ff; }

    hr{ border:none; border-top:1px solid var(--border); margin:14px 0; }

    input[type="date"]{
      background:#0d141d;
      border:1px solid var(--btnBorder);
      color:var(--ink);
      padding:10px 12px;
      border-radius:12px;
      min-height:44px;
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(7, minmax(0,1fr));
      gap:clamp(6px, 2vw, 8px);
    }

    .dayCell{
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px;
      background:#0d141d;
      min-height:clamp(64px, 12vw, 84px);
      cursor:pointer;
      user-select:none;
    }
    .dayCell:hover{ filter:brightness(1.08); }

    .badge{
      display:inline-block;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--primaryBorder);
      background:#122238;
      font-size:clamp(11px, 3vw, 12px);
      margin-top:6px;
    }

    .outline{ outline:2px solid #2a6bd4; }
    .muted{ opacity:.55; }

    @media (max-width:520px){
      .space{ justify-content:flex-start; }
      .row.space > div:last-child{ width:100%; }
      .btn{ flex:1 1 auto; }
    }
  </style>
</head>

<body>
<div class="container">

  <div class="row space">
    <div>
      <div class="h1">Stoic 30</div>
      <div id="range" class="small"></div>
    </div>
    <div class="row">
      <button id="btnTodayView" class="btn primary">Today</button>
      <button id="btnCalView" class="btn">Calendar</button>
    </div>
  </div>

  <hr/>

  <div class="row space">
    <div class="row">
      <label class="small">Start date (Day 1):</label>
      <input id="startDate" type="date" />
    </div>
    <div class="small" id="selectedMeta"></div>
  </div>

  <hr/>

  <div id="todayView" class="card"></div>
  <div id="calView" class="card" style="display:none;"></div>

</div>

<script>
(function(){

  function safeGet(k){ try{ return localStorage.getItem(k); }catch(e){ return null; } }
  function safeSet(k,v){ try{ localStorage.setItem(k,v); }catch(e){} }

  const PLAN = Array.from({length:30}, (_,i)=>({ day:i+1 }));

  const CONTENT = {
    1:["The Oath: No More Detecting","Withdrawal-like urge to check/confirm.","Write 1 page: What checking costs me.","You don't get to buy calm with dignity."],
    2:["Control Test","But I need to know.","Control vs Not Control list.","Confusing curiosity with control is your addiction."],
    3:["Delay Discipline","Impulse to bring it up.","24-hour delay + squats.","A man with frame can wait."],
    4:["Silence Under Fire","Over-explaining urge.","Speak only when asked.","Silence is restraint."],
    5:["No-Theory Day","Story building.","Say Not actionable.","Your mind isn't your master."],
    6:["Physical Authority","Anxiety in body.","20 min sweat.","Body sets the tone."],
    7:["Weekly Audit","Impatience.","Score habits.","Repeatable wins."],
    8:["Reclaim Morning","Threat scanning.","No phone 30 min.","Own the morning."],
    9:["Boundary Rehearsal","Talk fantasies.","One sentence boundary.","Boundaries aren't debates."],
    10:["Dignity Rep","Reassurance craving.","Fix one thing.","Competence lasts."],
    11:["Uncertainty Training","Mental itch.","Sit with discomfort.","You can survive it."],
    12:["No Retrial","Replays.","Facts only.","Stories trap."],
    13:["Scarcity Detox","Money fear.","Stability action.","Build, don't argue."],
    14:["Weekly Audit","Need sign.","Track outputs.","Consistency is the sign."],
    15:["Trigger Protocol","Surprise triggers.","Pick response.","Plan beats willpower."],
    16:["No Monitoring","Quick look urge.","Write integrity line.","Respect yourself."],
    17:["Respectful Distance","Cling vs withdraw.","Warm, not needy.","Presence is power."],
    18:["Competence Stack","Restlessness.","45-min build.","Builders spiral less."],
    19:["Speech Economy","Over explaining.","1–2 sentences.","Certainty speaks."],
    20:["Values","Confusion.","5 non-negotiables.","Define the line."],
    21:["Weekly Audit","Testing.","Pick boundary.","Standards matter."],
    22:["Posture","Feeling small.","Slow walk.","Body teaches brain."],
    23:["Observe","Force clarity urge.","Do nothing.","Patterns reveal."],
    24:["Calm Confrontation","Fear tone.","Practice once.","Clean beats loud."],
    25:["Discomfort","Anxiety peak.","Hard thing first.","Don't wait."],
    26:["Ritual","Night spirals.","Same routine.","Ritual beats mood."],
    27:["Give Clean","Earn safety urge.","No expectation.","Clean giving."],
    28:["Weekly Audit","Self test.","Compare day 1.","Behavior counts."],
    29:["Red Line","Boundary fear.","Write response.","Decided men are calm."],
    30:["Standard","Relaxing.","3 forever rules.","You're trained."]
  };

  const $ = id => document.getElementById(id);

  function toISO(d){
    const x=new Date(d); x.setMinutes(x.getMinutes()-x.getTimezoneOffset());
    return x.toISOString().slice(0,10);
  }
  function addDays(d,n){ const x=new Date(d); x.setDate(x.getDate()+n); return x; }

  const STATE={ view:"today", startISO:"", selectedISO:"" };

  function dayNum(){
    return Math.floor((new Date(STATE.selectedISO)-new Date(STATE.startISO))/(864e5))+1;
  }

  function setView(v){
    STATE.view=v;
    $("todayView").style.display=v==="today"?"block":"none";
    $("calView").style.display=v==="calendar"?"block":"none";
    $("btnTodayView").className="btn"+(v==="today"?" primary":"");
    $("btnCalView").className="btn"+(v==="calendar"?" primary":"");
    render();
  }

  function renderMeta(){
    $("selectedMeta").innerHTML=`Selected: <b>${new Date(STATE.selectedISO).toLocaleDateString()}</b> • Day <b>${dayNum()}</b>`;
    const s=new Date(STATE.startISO), e=addDays(s,29);
    $("range").textContent=`Plan range: ${s.toLocaleDateString()} → ${e.toLocaleDateString()}`;
  }

  function renderToday(){
    const d=dayNum();
    const c=CONTENT[d];
    if(!c){
      $("todayView").innerHTML="<div class='small'>No plan for this date.</div>";
      return;
    }
    $("todayView").innerHTML=`
      <div class="row space">
        <div>
          <div class="h2">Day ${d}: ${c[0]}</div>
          <div class="small">(Today)</div>
        </div>
        <div class="row">
          <a class="btn primary" href="Stoic30-Workbook-Fillable.pdf" target="_blank">Open Workbook (PDF)</a>
        </div>
      </div>
      <hr/>
      <div class="h2">You'll face</div><div>${c[1]}</div>
      <hr/>
      <div class="h2">Drill</div><div>${c[2]}</div>
      <hr/>
      <div class="h2">Mentor line</div><div>"${c[3]}"</div>
    `;
  }

  function renderCalendar(){
    const base=new Date(STATE.selectedISO);
    base.setDate(1);
    const first=base.getDay();
    const days=new Date(base.getFullYear(),base.getMonth()+1,0).getDate();
    let html=`<div class="h2">${base.toLocaleString(undefined,{month:"long",year:"numeric"})}</div><hr/><div class="grid">`;
    for(let i=0;i<first;i++) html+=`<div class="dayCell muted"></div>`;
    for(let i=1;i<=days;i++){
      const iso=toISO(new Date(base.getFullYear(),base.getMonth(),i));
      const d=Math.floor((new Date(iso)-new Date(STATE.startISO))/(864e5))+1;
      html+=`<div class="dayCell ${iso===STATE.selectedISO?"outline":""}" data-iso="${iso}">
        ${i}${d>=1&&d<=30?`<div class="badge">Day ${d}</div>`:""}
      </div>`;
    }
    html+="</div>";
    $("calView").innerHTML=html;
    $("calView").querySelectorAll("[data-iso]").forEach(el=>{
      el.onclick=()=>{ STATE.selectedISO=el.dataset.iso; setView("today"); };
    });
  }

  function render(){
    renderMeta();
    renderToday();
    renderCalendar();
  }

  function init(){
    const today=toISO(new Date());
    STATE.startISO=safeGet("stoic30_start")||today;
    STATE.selectedISO=today;
    $("startDate").value=STATE.startISO;
    $("btnTodayView").onclick=()=>setView("today");
    $("btnCalView").onclick=()=>setView("calendar");
    $("startDate").onchange=e=>{
      STATE.startISO=e.target.value;
      safeSet("stoic30_start",STATE.startISO);
      render();
    };
    render();
  }

  init();
})();
</script>
</body>
</html>
